<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Note: sha is added only for two inline scripts -->
    <meta http-equiv="Content-Security-Policy"
        content="script-src 'sha256-4lqVHj4azlKKnv/taP8Iv/iUAJvKv8XN+g04rNX53Tk=' 'sha256-nKMOHriIPDLP74ohjH4Y/cod+1qe40/fxJ7FtwkXs64='">
    <script>
        console.log(`${Date.now()} inline script in the head`);
        document.addEventListener('DOMContentLoaded', () => {
            console.log(`${Date.now()} DOMContentLoaded`);
        })
        document.addEventListener('transitionend', () => {
            console.log(`${Date.now()} transitionend`);
        })
        document.addEventListener('readyState', () => {
            console.log(`${Date.now()} readyState ${document.readyState}`);
        })
        window.onload = () => {
            console.log(`${Date.now()} window on load`);
        }
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Injection Speed Test — Simple page with CSP 'script-src'</title>
    <link rel="stylesheet" href="../styles.css">
</head>

<body>

    <div class="container mt-5">
        <h1>Injection Speed Test — Simple page with CSP 'script-src'</h1>

        <section class="description">
            <h2>Compatibility notes</h2>

            <p>
                ⚠️ <b>Browser Extension in Firefox</b> may need to make a
                second attempt to inject scripts and you'll see an error in the
                console.

            <details>
                <summary>See the screenshot</summary>

                <img src="simple-with-csp--firefox-error.png" width="600px" class="mt-2 img-border" />
            </details>
            </p>

            <p>
                ⚠️ <b>Browser Extension MV3</b> will only be able to run
                scriptlet and "registered script" on this page.
            </p>

            <p>
                ⚠️ <b>AdGuard for iOS</b> may inject scripts too slowly.

                Also, only scriptlet and "registered script" rule will work on
                this page.
            </p>

            <p>
                ⚠️ <b>AdGuard Mini for macOS</b> won't be able to circumvent
                CSP on this page and the rules won't work.
            </p>
        </section>

        <section class="description">
            <h2 class="h4 mb-3">How to Test</h2>
            <article>
                <ol class="list-group list-group-numbered">
                    <li class="list-group-item">Open devtools</li>
                    <li class="list-group-item">Reload page</li>
                    <li class="list-group-item">
                        <p>
                            Make sure that script and scriptlet rules were injected at least before the inline script at
                            the end.
                        </p>
                        <details>
                            <summary>See the screenshot</summary>

                            <img src="simple-with-csp--ok.png" width="600px" class="mt-2 img-border" />
                        </details>
                    </li>
                </ol>
            </article>
        </section>

        <p class="mt-4"><a href="../">Go Back</a></p>
    </div>

    <script>
        console.log(`${Date.now()} inline script in the end`);
    </script>

</body>

</html>